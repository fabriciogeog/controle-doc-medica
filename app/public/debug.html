<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Sistema M√©dico</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .debug-box { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .status { padding: 10px; border-radius: 4px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        #logs { background: #f8f9fa; padding: 15px; border-radius: 4px; font-family: monospace; height: 300px; overflow-y: auto; border: 1px solid #dee2e6; }
    </style>
</head>
<body>
    <h1>üîß Debug do Sistema M√©dico</h1>
    
    <div class="debug-box">
        <h2>Status do JavaScript</h2>
        <div id="js-status" class="status info">Verificando...</div>
        
        <h3>Vari√°veis Globais</h3>
        <div id="global-vars"></div>
        
        <h3>Testes de Fun√ß√£o</h3>
        <button onclick="testLoginFunction()">Testar Login</button>
        <button onclick="testUploadFunction()">Testar Upload</button>
        <button onclick="testEditFunction()">Testar Edi√ß√£o</button>
        <button onclick="testDeleteFunction()">Testar Exclus√£o</button>
        
        <h3>Logs de Debug</h3>
        <div id="logs"></div>
    </div>

    <script>
        function log(message) {
            const logs = document.getElementById('logs');
            const timestamp = new Date().toLocaleTimeString();
            logs.innerHTML += `[${timestamp}] ${message}<br>`;
            logs.scrollTop = logs.scrollHeight;
            console.log(message);
        }

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('js-status');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
        }

        function checkGlobalVars() {
            const varsDiv = document.getElementById('global-vars');
            let html = '';
            
            // Verificar app
            if (typeof window.app !== 'undefined') {
                html += '<div class="status success">‚úÖ window.app: Dispon√≠vel</div>';
                log('‚úÖ window.app est√° dispon√≠vel');
                
                // Verificar m√©todos da app
                const methods = ['editarDocumento', 'confirmarExclusao', 'salvarDocumento'];
                methods.forEach(method => {
                    if (typeof window.app[method] === 'function') {
                        html += `<div class="status success">‚úÖ app.${method}: Fun√ß√£o dispon√≠vel</div>`;
                        log(`‚úÖ app.${method} √© uma fun√ß√£o`);
                    } else {
                        html += `<div class="status error">‚ùå app.${method}: N√£o dispon√≠vel</div>`;
                        log(`‚ùå app.${method} n√£o est√° dispon√≠vel`);
                    }
                });
            } else {
                html += '<div class="status error">‚ùå window.app: N√£o dispon√≠vel</div>';
                log('‚ùå window.app n√£o est√° dispon√≠vel');
            }
            
            varsDiv.innerHTML = html;
        }

        function testLoginFunction() {
            log('üîç Testando fun√ß√£o de login...');
            if (typeof window.app !== 'undefined' && typeof window.app.login === 'function') {
                log('‚úÖ Fun√ß√£o de login encontrada');
                // Teste b√°sico sem executar
                updateStatus('Fun√ß√£o de login OK', 'success');
            } else {
                log('‚ùå Fun√ß√£o de login n√£o encontrada');
                updateStatus('Fun√ß√£o de login ERRO', 'error');
            }
        }

        function testUploadFunction() {
            log('üîç Testando fun√ß√£o de upload...');
            const form = document.querySelector('#cadastroForm');
            if (form) {
                log('‚úÖ Formul√°rio de cadastro encontrado');
                updateStatus('Formul√°rio de upload OK', 'success');
            } else {
                log('‚ùå Formul√°rio de cadastro n√£o encontrado');
                updateStatus('Formul√°rio de upload ERRO', 'error');
            }
        }

        function testEditFunction() {
            log('üîç Testando fun√ß√£o de edi√ß√£o...');
            if (typeof window.app !== 'undefined' && typeof window.app.editarDocumento === 'function') {
                log('‚úÖ Fun√ß√£o editarDocumento encontrada');
                
                // Testar se o modal existe
                const modal = document.getElementById('editModal');
                if (modal) {
                    log('‚úÖ Modal de edi√ß√£o encontrado');
                    updateStatus('Fun√ß√£o de edi√ß√£o OK', 'success');
                } else {
                    log('‚ùå Modal de edi√ß√£o n√£o encontrado');
                    updateStatus('Modal de edi√ß√£o ERRO', 'error');
                }
            } else {
                log('‚ùå Fun√ß√£o editarDocumento n√£o encontrada');
                updateStatus('Fun√ß√£o de edi√ß√£o ERRO', 'error');
            }
        }

        function testDeleteFunction() {
            log('üîç Testando fun√ß√£o de exclus√£o...');
            if (typeof window.app !== 'undefined' && typeof window.app.confirmarExclusao === 'function') {
                log('‚úÖ Fun√ß√£o confirmarExclusao encontrada');
                
                // Testar se o modal existe
                const modal = document.getElementById('confirmModal');
                if (modal) {
                    log('‚úÖ Modal de confirma√ß√£o encontrado');
                    updateStatus('Fun√ß√£o de exclus√£o OK', 'success');
                } else {
                    log('‚ùå Modal de confirma√ß√£o n√£o encontrado');
                    updateStatus('Modal de confirma√ß√£o ERRO', 'error');
                }
            } else {
                log('‚ùå Fun√ß√£o confirmarExclusao n√£o encontrada');
                updateStatus('Fun√ß√£o de exclus√£o ERRO', 'error');
            }
        }

        // Executar verifica√ß√µes quando a p√°gina carregar
        window.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Iniciando debug...');
            
            // Aguardar um pouco para o app carregar
            setTimeout(() => {
                checkGlobalVars();
                
                if (typeof window.app !== 'undefined') {
                    updateStatus('JavaScript carregado com sucesso!', 'success');
                    log('‚úÖ Sistema JavaScript funcionando');
                } else {
                    updateStatus('Erro: JavaScript n√£o carregado', 'error');
                    log('‚ùå Sistema JavaScript com problemas');
                }
            }, 1000);
        });
    </script>
</body>
</html>
