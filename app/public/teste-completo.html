<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Teste Completo do Sistema</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .debug-section {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        .debug-section h3 {
            margin-top: 0;
            color: #495057;
        }
        .status {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
        .btn-test {
            margin: 5px;
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: 1px solid #007bff;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn-test:hover { background: #0056b3; }
        #logOutput {
            max-height: 300px;
            overflow-y: auto;
            background: #212529;
            color: #f8f9fa;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Elementos DOM necessÃ¡rios para o JavaScript funcionar -->
    <div id="loginModal" class="modal" style="display: none;">
        <div class="modal-content">
            <form id="loginForm">
                <input type="password" id="senha" name="senha">
            </form>
            <div id="loginError" class="error-message" style="display: none;"></div>
        </div>
    </div>

    <div id="app" style="display: block;">
        <header class="app-header">
            <div class="header-content">
                <h1>ğŸ§ª Teste Completo - Sistema JavaScript</h1>
                <button id="logoutBtn" class="btn btn-outline">Sair</button>
            </div>
        </header>

        <main class="main-content">
            <!-- Debug Section -->
            <div class="debug-section">
                <h3>ğŸ“Š Status do JavaScript</h3>
                <div id="statusContainer">
                    <div class="status info">â³ Carregando...</div>
                </div>
            </div>

            <!-- Test Section -->
            <div class="debug-section">
                <h3>ğŸ§ª Testes de Funcionalidade</h3>
                <div>
                    <button class="btn-test" onclick="testarSeletorArquivos()">ğŸ“ Testar Seletor</button>
                    <button class="btn-test" onclick="testarFuncaoExclusao()">ğŸ—‘ï¸ Testar ExclusÃ£o</button>
                    <button class="btn-test" onclick="testarFuncaoEdicao()">âœï¸ Testar EdiÃ§Ã£o</button>
                    <button class="btn-test" onclick="testarToast()">ğŸ”” Testar Toast</button>
                    <button class="btn-test" onclick="executarDiagnostico()">ğŸ”„ Reexecutar</button>
                </div>
            </div>

            <!-- Log Section -->
            <div class="debug-section">
                <h3>ğŸ“‹ Log de Testes</h3>
                <div id="logOutput">Aguardando diagnÃ³stico...</div>
            </div>

            <!-- Test Form Section -->
            <div class="debug-section">
                <h3>ğŸ“ Teste do FormulÃ¡rio com Seletor</h3>
                <form id="cadastroForm" style="max-width: 600px;">
                    <div class="form-group full-width">
                        <label for="caminhos">Arquivos do Documento:</label>
                        
                        <!-- BotÃ£o para abrir navegador de arquivos -->
                        <div style="margin-bottom: 15px;">
                            <input type="file" id="seletorArquivos" multiple accept=".pdf,.jpg,.jpeg,.png,.gif,.webp" style="display: none;" onchange="app.capturarCaminhos(this)">
                            <button type="button" class="btn btn-outline" onclick="document.getElementById('seletorArquivos').click()">
                                ğŸ“ Navegar e Selecionar Arquivos
                            </button>
                        </div>
                        
                        <!-- Lista de arquivos selecionados -->
                        <div id="listaArquivosSelecionados" style="margin-bottom: 15px;"></div>
                        
                        <!-- Campo hidden com caminhos -->
                        <textarea id="caminhos" name="caminhos" rows="3" style="display: none;"></textarea>
                        
                        <small>ğŸ“ Clique em "Navegar e Selecionar Arquivos" para escolher documentos.</small>
                    </div>
                    
                    <div class="form-group">
                        <input type="text" placeholder="DescriÃ§Ã£o do documento" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">ğŸ’¾ Salvar Documento</button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <!-- Modal de ConfirmaÃ§Ã£o -->
    <div id="confirmModal" class="modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h2>âš ï¸ Confirmar AÃ§Ã£o</h2>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Tem certeza?</p>
            </div>
            <div class="modal-actions">
                <button id="confirmYes" class="btn btn-danger">Sim</button>
                <button id="confirmNo" class="btn btn-outline">NÃ£o</button>
            </div>
        </div>
    </div>

    <!-- Loading e Toast -->
    <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
        <p>Carregando...</p>
    </div>

    <div id="toast" class="toast" style="display: none;">
        <div id="toastMessage"></div>
    </div>

    <!-- Links de NavegaÃ§Ã£o -->
    <div style="text-align: center; padding: 20px; background: #f8f9fa; margin-top: 20px;">
        <a href="/" class="btn btn-primary">ğŸ  Sistema Principal</a>
        <a href="/debug.html" class="btn btn-outline">ğŸ”§ Debug Original</a>
        <a href="/debug-simples.html" class="btn btn-outline">ğŸ” Debug Simples</a>
        <a href="/teste-seletor.html" class="btn btn-outline">ğŸ“ Teste Seletor</a>
    </div>

    <!-- JavaScript -->
    <script src="js/app.js"></script>
    
    <script>
        function log(message) {
            const output = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
        }
        
        function setStatus(message, type = 'info') {
            const container = document.getElementById('statusContainer');
            container.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function executarDiagnostico() {
            const output = document.getElementById('logOutput');
            output.textContent = 'Iniciando diagnÃ³stico...\n';
            
            log('ğŸš€ Executando diagnÃ³stico completo...');
            log(`âœ… DOM: ${document.readyState}`);
            
            // Verificar window.app
            if (typeof window.app !== 'undefined') {
                log('âœ… window.app estÃ¡ disponÃ­vel');
                log(`   Tipo: ${typeof window.app}`);
                log(`   Construtor: ${window.app.constructor.name}`);
                
                // Testar mÃ©todos
                const metodosParaTestar = [
                    'capturarCaminhos',
                    'abrirArquivo',
                    'editarDocumento',
                    'confirmarExclusao',
                    'salvarDocumento',
                    'showToast',
                    'loadDashboard'
                ];
                
                let metodosOK = 0;
                metodosParaTestar.forEach(metodo => {
                    if (typeof window.app[metodo] === 'function') {
                        log(`âœ… MÃ©todo ${metodo} disponÃ­vel`);
                        metodosOK++;
                    } else {
                        log(`âŒ MÃ©todo ${metodo} NÃƒO encontrado`);
                    }
                });
                
                if (metodosOK === metodosParaTestar.length) {
                    setStatus(`âœ… JavaScript 100% funcional! (${metodosOK}/${metodosParaTestar.length} mÃ©todos)`, 'success');
                } else {
                    setStatus(`âš ï¸ JavaScript parcialmente funcional (${metodosOK}/${metodosParaTestar.length} mÃ©todos)`, 'warning');
                }
                
            } else {
                log('âŒ window.app NÃƒO disponÃ­vel');
                setStatus('âŒ JavaScript com problemas - window.app nÃ£o encontrado', 'error');
            }
            
            // Verificar DocumentacaoMedica
            if (typeof DocumentacaoMedica !== 'undefined') {
                log('âœ… Classe DocumentacaoMedica disponÃ­vel');
            } else {
                log('âŒ Classe DocumentacaoMedica NÃƒO encontrada');
            }
            
            // Verificar elementos DOM
            const elementos = ['cadastroForm', 'loginForm', 'app', 'loading', 'confirmModal', 'toast'];
            elementos.forEach(elementId => {
                const elemento = document.getElementById(elementId);
                if (elemento) {
                    log(`âœ… Elemento #${elementId} encontrado`);
                } else {
                    log(`âŒ Elemento #${elementId} NÃƒO encontrado`);
                }
            });
            
            log('ğŸ DiagnÃ³stico concluÃ­do.');
        }
        
        // Testes especÃ­ficos
        function testarSeletorArquivos() {
            log('ğŸ“ Testando seletor de arquivos...');
            if (typeof window.app !== 'undefined' && typeof window.app.capturarCaminhos === 'function') {
                log('âœ… FunÃ§Ã£o capturarCaminhos disponÃ­vel');
                const seletor = document.getElementById('seletorArquivos');
                if (seletor) {
                    seletor.click();
                    log('âœ… Seletor de arquivos acionado');
                } else {
                    log('âŒ Elemento seletorArquivos nÃ£o encontrado');
                }
            } else {
                log('âŒ FunÃ§Ã£o capturarCaminhos nÃ£o disponÃ­vel');
            }
        }
        
        function testarFuncaoExclusao() {
            log('ğŸ—‘ï¸ Testando funÃ§Ã£o de exclusÃ£o...');
            if (typeof window.app !== 'undefined' && typeof window.app.confirmarExclusao === 'function') {
                window.app.confirmarExclusao('teste-id', 'Documento de Teste');
                log('âœ… Modal de confirmaÃ§Ã£o de exclusÃ£o aberto');
            } else {
                log('âŒ FunÃ§Ã£o confirmarExclusao nÃ£o disponÃ­vel');
            }
        }
        
        function testarFuncaoEdicao() {
            log('âœï¸ Testando funÃ§Ã£o de ediÃ§Ã£o...');
            if (typeof window.app !== 'undefined' && typeof window.app.editarDocumento === 'function') {
                log('âœ… FunÃ§Ã£o editarDocumento disponÃ­vel (teste simulado)');
            } else {
                log('âŒ FunÃ§Ã£o editarDocumento nÃ£o disponÃ­vel');
            }
        }
        
        function testarToast() {
            log('ğŸ”” Testando sistema de notificaÃ§Ãµes...');
            if (typeof window.app !== 'undefined' && typeof window.app.showToast === 'function') {
                window.app.showToast('ğŸ‰ Teste de notificaÃ§Ã£o funcionando!', 'success');
                log('âœ… Toast de teste exibido');
            } else {
                log('âŒ FunÃ§Ã£o showToast nÃ£o disponÃ­vel');
            }
        }
        
        // Executar diagnÃ³stico quando carregar
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(executarDiagnostico, 1000);
        });
    </script>
</body>
</html>
